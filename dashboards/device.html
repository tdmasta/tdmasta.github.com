---
layout: page-ng
title: Device dashboard
tagline: Messages history
description: Dashboard with transmitted datas
scripts:
- {name: validation, type: remote, url: "https://ajax.aspnetcdn.com/ajax/jquery.validate/1.9/jquery.validate.min.js"}
- {name: validation.nonobs, type: remote, url: "https://ajax.aspnetcdn.com/ajax/mvc/3.0/jquery.validate.unobtrusive.js"}
- {name: app, type: remote, url: "/assets/app/js/app.js"}
- {name: controller, type: remote, url: "/assets/app/js/controllers.js"}
- {name: service, type: remote, url: "/assets/app/js/services.js"}
- {name: pines, type: remote, url: "/assets/app/lib/jquery.pnotify.min.js"}
- {name: modernizr, type: remote, url: "/assets/app/js/mdz.js"}
- {name: base64, type: remote, url: "https://stringencoders.googlecode.com/svn-history/r230/trunk/javascript/base64.js"}
---

{% include JB/setup %}

<div ng-app="evbApp" ng-controller="DashboardCtrl">

    <div ng:show="_displayDashboard != true" ng:cloak>
	   <div class="row" style="margin: 0 auto;display: table;">
            <div class="span5">
                <form class="form-horizontal" accept-charset="utf-8" auto-complete="off" novalidate="novalidate" id="authenticationBySerial" name="authenticationBySerialForm" ng-controller="AuthenticationCtrl" ng-app="evbApp" ng-submit="authenticationBySerialSubmit(account, displayDashboard)" >
					<legend> Device Authentication</legend>
                    <div class="control-group">
                        <label class="control-label" for="inputSerial" data-toggle="popover" data-placement="bottom" data-content="<p>Module id appears either on product parcel sticker<br/> either by perfoming AT&V command within a terminal session.</p>" data-html="true" data-original-title="<strong>What's this ?</strong>"><a href="#"><i class="icon-question-sign icon-large"></i>  Enter module id </a></label>
                        <div class="controls">
                            <input id="inputSerial" name="account.inputSerial" ng-model="account.inputSerial" ng-model-instant data-val="true" type="text" data-val-required="Serial is required." required placeholder="e.g XXXX, case insentitive, with no 0 padding" />
                            <span class="field-validation-valid" data-valmsg-for="inputSerial" data-valmsg-replace="true"></span>
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label" for="inputKey" data-toggle="popover" data-placement="bottom" data-content="<p>Key information appears next to Module Id information on product parcel sticker</p>" data-html="true" data-original-title="<strong>Where can I get the Key info?</strong>"><a href="#"><i class="icon-question-sign icon-large"></i>  its key </a></label>
                        <div class="controls">
                            <input id="inputKey" name="account.inputKey" ng-model="account.inputKey" ng-model-instant data-val="true" type="text" data-val-required="Key is required." required placeholder="8 hexa chars, case insentitive" />
                            <span class="field-validation-valid" data-valmsg-for="inputKey" data-valmsg-replace="true"></span>
                        </div>
                    </div>
                    <div class="control-group">
                        <div class="controls">
                            <button type="submit" class="btn btn-success btn-large">Then get to dashoard</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div ng:show="_displayDashboard == true">
		<div class="row">
			<div class="span12">
				<center>last update {{"{{_lastUpdate | date:'medium' "}}}} </center>
			</div>
		</div>
		<div class="row">
			<div class="span12">
				<h3> <i class="icon-dashboard"> </i> Module {{"{{_serial"}}}} status <span class="pull-right"><button type="button" class="btn btn-warning" ng-app="evbApp" ng-controller="LogOutCtrl" ng-click="logOut()" ng:show="(_display == true) && (undefined != _serial)" ng:cloak>Switch from {{"{{_serial"}}}} </button> <button type="button" class="btn btn-warning" ng-app="evbApp" ng-controller="LogOutCtrl" ng-click="logOut()" ng:show="(display == true) && (undefined == _serial)" ng:cloak>Logout</button> </span></h3>
					<ng-switch on="_devices.length == 0">
		                <div ng-switch-when="true">
							<center><i class="icon-spinner icon-spin"></i></center>
						</div>
						<div ng-switch-when="false">
							<div class="well span3 fade in" ng-repeat="(id, d) in _devicesMap | orderBy:'d.idx'">
								<div class="modal-header">
								<i class="icon-hdd icon-2x snsr-{{"{d.uid"}}}}"></i> <span class="label label-info">{{"{{d.uid"}}}}</span></a> | <span class="badge badge-success">{{"{{d.idx"}}}}</span> |  <span class="label label-warning">{{"{{d.category"}}}}</span>
								</div>
								<div class="modal-footer">
									<ul class="unstyle inline">
										<li class="pull-left"><a href="#" class="indicator" data-toggle="popover" data-placement="bottom" data-original-title="Device information" data-content="<p>{{"{{d.uid"}}}<br/></p>" data-html="true"></a></li>
										<li><a href="#" class="indicator" data-toggle="tooltip" data-original-title="Battery status indicator : {{"{{d.battery"}}}}"><i class="icon-bolt icon-2x snsr-{{"{{d.battery"}}}}"></i></a></li>
										<li><a href="#" class="indicator" data-toggle="tooltip" data-original-title="Sigfox wireless signal status indicator : {{"{{d.level"}}}}"><i class="icon-signal icon-2x snsr-{{"{{d.level"}}}}"></i></a></li>
										<li><a href="#" class="indicator" data-toggle="tooltip" data-original-title="Local network connection status indicator : {{"{{d.network"}}}}"><i class="icon-rss icon-2x snsr-{{"{{d.network"}}}}"></i></a></li>
										<li><a href="#" class="indicator" data-toggle="tooltip" data-original-title="Temperature status indicator : {{"{{d.temp"}}}}"><i class="icon-certificate icon-2x snsr-{{"{{d.temp"}}}}"></i></a></li>
										<li><a href="#" class="indicator" data-toggle="tooltip" data-original-title="Switch status indicator : {{"{{d.tamper"}}}}"><i class="icon-exclamation-sign icon-2x snsr-{{"{{d.tamper"}}}}"></i></a></li>
									</ul>
								</div>
							</div>
						</div>
					</ng-switch>
			</div>
		</div>

		<div class="row">
			<div class="span2 pull-right">
				<a href="#history" data-toggle="modal" >Show details</a>
			</div>
		</div>
			
		<div id="history" class="modal hide fade in">
			<div class="modal-header">
				<a class="close" data-dismiss="modal">&times;</a>
				<h3> <i class="icon-time"> </i> History </h3>
			</div>
			<div class="modal-body">
				<div class="span5" when-scrolled="loadMore();" ng:cloak class="container" id="fixed">
		            <ng-switch on="_messages.length == 0">
		                <div ng-switch-when="true">
		                    <table class="table table-striped table-condensed table-hover">
		                        <thead>
		                            <th>Date</th>
		                            <th>Channel</th>
		                            <th>Msg</th>
									<th>[Payload]</th>
		                        </thead>
		                        <tbody ng-switch>
		                            <tr>
		                                <td colspan="4"><center><i class="icon-spin icon-spinner"></i> No message found</center></td>
		                            </tr>
		                        </tbody>
		                    </table>
		                </div>
		                <div ng-switch-when="false">
		                    <table class="table table-striped table-condensed table-hover">
		                        <thead>
		                            <th>Date</th>
		                            <th>Channel</th>
		                            <th>Msg</th>
		                            <th>[Payload]</th>
		                        </thead>
		                        <tbody ng-switch>
		                            <tr ng-repeat="message in _messages">
		                                <td>{{"{{message.when | date : 'yyyy-MM-dd HH:mm:ss' "}}}}</td>
										<td>{{"{{message.extra.ctxt.index"}}}}</td>
										<td>{{"{{message.extra.type"}}}}</td>
										<td>{{"{{message.extra.payload"}}}}</td>
		                            </tr>
									<tr>
										<td colspan="4"><center><i class="icon-spin icon-spinner"></i></center></td>
									</tr>
		                        </tbody>
		                    </table>
		                </div>
		            </ng-switch>
				</div>
			</div>
			<div class="modal-footer">
				<a class="btn" data-dismiss="modal">Close</a>
			</div>
		</div>
	</div>
	</div>
</div>